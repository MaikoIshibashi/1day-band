"use client";
import { useState, useEffect } from "react";
import Link from "next/link";

export default function FAQPage() {
  const faqCategories = [
    {
      category: "参加について",
      items: [
        { q: "初心者でも大丈夫ですか？", a: "はい、大丈夫です！むしろ大歓迎です！ぜひみんなで一緒に弾く楽しさを体感してみてください。" },
        { q: "誰でも参加できますか？", a: "不特定多数の応募があるため参加には選考があります。また、安全性を確認とグループDMでの運用のためXアカウントのある方を対象としています。" },
        { q: "楽器が演奏できなくても参加できますか？", a: "基本的にはバンド楽器演奏がメインとなりますが、ボーカルやコーラスなどの場合は楽器が弾けなくても問題ありません。タンバリン参加もOKです！" },
        { q: "年齢制限はありますか？", a: "何歳でも大丈夫です！お子様の場合は保護者の同意が必要です。" },
        { q: "キーボードとギターなど掛け持ちはできますか？", a: "はい！可能です。ご希望はお伺いしますが人数調整で難しい場合もあります。" },
        { q: "第一希望と第二希望のパートがどちらも埋まっていた場合どうなりますか？", a: "分担して演奏が可能な場合もあります。まだ募集中の場合はエントリーしてみてください。" },
        { q: "初対面の人ばかりで不安ですが大丈夫ですか？", a: "本番までの5ヶ月間、グループDMで練習の様子や相談などを共有できます！良い方ばかりなのでぜひ積極的にやり取りしてみてください🎵" },
        { q: "練習は当日だけですか？事前に集まることはありますか？", a: "各地から集まることが多いので全員集まることは難しいですが、一部メンバーで集まることは可能です。(主催者は基本的に遠方なので参加が難しいです)" },
        { q: "参加申し込みの締め切りはいつですか？", a: "エントリー開始から約1週間で締め切ります。開始時にエントリー期間は発表します。" },
        { q: "キャンセルは可能ですか？", a: "はい、可能ですが出来るだけ早いご連絡をいただけると助かります。" },
        { q: "飲み会参加は必須ですか？", a: "参加・不参加はオプションで選択できます！" },
        { q: "打ち上げ参加の変更はできますか？", a: "はい。途中変更OKです。" },
        { q: "過去に参加した人もまた参加できますか？", a: "はい！ぜひご参加ください！" },
        { q: "持ち込み機材はありますか？", a: "楽器によって異なりますが、揃っているのは基本的にドラムとボーカルとキーボードのみです。" },
        { q: "打ち上げ参加したいですがお酒飲めなくてもいいですか？", a: "全然気にせずご参加ください！" },
        { q: "パートの種類を教えてください", a: "ギター、ベース、ドラム、キーボード、ボーカル、コーラスになります。" },
      ],
    },
    {
      category: "費用について",
      items: [
        { q: "参加費はいくらですか？", a: "参加費は5000円です。＋オプション4000円追加で打ち上げに参加できます。¥n参加費の内訳は以下となります！¥nスタジオ利用（5H）＋機材レンタル¥n記念品（バンドメンバーの名前入り）¥nスコア（パート割含む）¥nYouTube動画（本番2本／MIX込）¥nYouTubeショート ※任意参加（中間イベントコラボ2本／MIX込）¥n当日動画と写真の共有¥nメンバー限定XグループDMご案内¥nメンバーズサイト利用¥nイベントチケット兼領収書発行" },
        { q: "支払い方法は何がありますか？", a: "現金、PayPay、クレジットカード各種に対応しています。" },
        { q: "当日までに費用を支払う必要がありますか？", a: "当日支払いでも事前支払いでもどちらでもOKです！" },
        { q: "キャンセル料は発生しますか？", a: "キャンセル料はありません。参加不可が分かり次第早めにご連絡ください。" },
        { q: "記念品や動画の費用は参加費に含まれていますか？", a: "はい！全て込み込みの金額になります。" },
        { q: "遠方からの参加の場合、交通費や宿泊費は自己負担ですか？", a: "はい。自己負担でお願いしますm(_ _)m" },
        { q: "領収証など発行してもらえますか？", a: "はい、チケット兼領収書を発行いたします。" },
      ],
    },
    {
      category: "演奏について",
      items: [
        { q: "スタジオに行ったことがありませんが大丈夫でしょうか？", a: "大丈夫です！接続方法など不安な方はフォローしますのでお知らせください♪" },
        { q: "誰かと演奏したことがありません。", a: "絶好の機会ですね！ぜひ音をみんなで合わせる楽しさを体感してください！" },
        { q: "パート割はどうなりますか？", a: "スキルやご希望により調整させていただきます。" },
        { q: "音作りがわかりません。", a: "音源に寄せると方向性は見えやすいですが特に正解があるわけではありません。不安であれば動画などを送っていただければアドバイスします。" },
        { q: "楽譜が読めません。", a: "基本的に譜面で指定しますが、不明箇所はサポートします。必要な場合は動画で案内することもあります。" },
        { q: "1曲丸ごとは弾けませんが大丈夫ですか？", a: "経験歴や希望を確認して弾ける範囲で問題ありません。ご相談いただいた内容でパート割しますのでご安心ください。" },
        { q: "間違えたらどうしようと不安です。", a: "ミスしても問題ないです！楽しい時間になってもらえたら大丈夫なので不安にならないよう出来る限り練習して臨んでみてください★" },
        { q: "動画とCDの音源どれが譜面と全く同じですか？", a: "ほぼ同様ですが完全にCDや映像と同じではありません。譜面でパートをお伝えしますのでその通り覚えてもらえればOKです。難しければ簡単アレンジに変えてもOKです！" },
        { q: "ボーカル初めてですが良いですか？", a: "初めてでも全然大丈夫です！生バンドで歌う楽しさを満喫してください！" },
        { q: "譜面やカンペ見てもいいですか？", a: "はい！見ていただいて全然大丈夫です。譜面台がありますのでご活用ください。" },
        { q: "立って演奏できません。", a: "椅子を準備しますので座って演奏でも大丈夫です^^/" },
      ],
    },
    {
      category: "当日について",
      items: [
        { q: "日にちはいつになりますか？", a: "基本的に土日になります。参加メンバーと調整してご連絡します。出来るだけご希望に合わせられるようにします。" },
        { q: "集合時間は何時ですか？", a: "参加者の都合に合わせて細かい時間は調整しますが、昼前〜夜までが多いです。" },
        { q: "会場はどこですか？", a: "毎回地域により異なります。出来るだけ広いスタ寺を探して決定次第ご連絡します。" },
        { q: "どのくらいの時間演奏しますか？", a: "スタジオの時間は5Hですが、途中休憩もあります。" },
        { q: "見学や応援だけの参加は可能ですか？", a: "基本的に見学だったらタンバリンを…と何か持たせたがる主催者ですw カメラや音響などサポーター大歓迎です。" },
        { q: "当日必要な持ち物はありますか？", a: "普段演奏する際に必要な機材をお持ちください。心配な場合はご相談ください。" },
        { q: "服装に決まりはありますか？", a: "自由ですが、動画を撮るので映っても問題ない服装でお願いします。" },
        { q: "リハーサルはどのくらい行いますか？", a: "トータル2時間くらい練習時間があります。" },
        { q: "昼ごはんはどうなりますか？", a: "打ち上げがあるので特に食べる時間は設けていませんがお腹が空きそうであればちょっとした軽食を持参してもかまいません。その場合は休憩時間にスタジオの外でお召し上がりください。" },
        { q: "飲み物はどうなりますか？", a: "ペットボトルなどキャップ付きの物をお持ち込みください。スタジオ付近にも自販機はあることが多いです。" },
        { q: "当日体調不良で参加できなくなった場合はどうすればいいですか？", 
          a: <>公式メールアドレスにご連絡ください：
            <Link href="mailto:info@1daystudioband.com" style={{ color: "var(--color-accent)", textDecoration: "underline" }}>
              info@1daystudioband.com
            </Link>
          </>
        },
      ],
    },
    {
      category: "その他",
      items: [
        { q: "参加人数は何人くらいですか？", a: "エントリーの人数によります。4名以上8名以下を想定しています。" },
        { q: "メンバーが集まらない場合どうなりますか？", a: "出来るだけ集められるよう呼びかけは頑張ります！あまりにも少ない場合はイベント延期または開催地変更の場合もあります。パートにもよりますが現地集合不可であれば音源提供可能な方を募集することやドラムの場合は打ち込みも検討します。" },
        { q: "男女比や年齢層はどんな感じですか？", a: "平均年齢は30代以上50代くらいが多いです。" },
        { q: "音楽ジャンルは限定されていますか？", a: "主催者の好みで基本的にGLAYです。エントリー開始時に発表します。" },
        { q: "写真や動画がSNSに公開される場合がありますか？", a: "動画や写真は公開しますが事前に確認します！モザイク処理はご希望に合わせて対応します。" },
        { q: "次回開催予定はありますか？", a: "春と秋の年に2回開催予定です。開催地は全国各地で毎回異なります。どこになるのかはエントリー前にご案内します。" },
      ],
    },
  ];

  // 最初から全カテゴリー・全Q&Aを展開
  const [openCategory, setOpenCategory] = useState(
    Object.fromEntries(faqCategories.map((_, i) => [i, true]))
  );
  const [openItem, setOpenItem] = useState(
    Object.fromEntries(faqCategories.flatMap((cat, i) => cat.items.map((_, j) => [`${i}-${j}`, true])))
  );

  const [visible, setVisible] = useState(false);

  useEffect(() => {
    setVisible(false);
    const t = setTimeout(() => setVisible(true), 50);
    return () => clearTimeout(t);
  }, []);

  const toggleCategory = (i: number) => {
    setOpenCategory((prev) => ({ ...prev, [i]: !prev[i] }));
  };

  const toggleItem = (key: string) => {
    setOpenItem((prev) => ({ ...prev, [key]: !prev[key] }));
  };

  return (
    <section className={`reveal ${visible ? "visible" : ""}`} style={{ padding: "4rem", backgroundColor: "#000", color: "white" }}>
      <h2 style={{ fontSize: "2rem", color: "var(--color-accent)", textAlign: "center", marginBottom: "2rem" }}>
        FAQ（よくある質問）
      </h2>

      <div style={{ maxWidth: "800px", margin: "0 auto" }}>
        {faqCategories.map((cat, i) => (
          <div key={i} style={{ marginBottom: "2rem" }}>
            <div
              onClick={() => toggleCategory(i)}
              style={{
                cursor: "pointer",
                fontSize: "1.5rem",
                fontWeight: "bold",
                borderBottom: "2px solid var(--color-accent)",
                paddingBottom: "0.5rem",
                marginBottom: "1rem",
                display: "flex",
                justifyContent: "space-between",
                color: "#eee", // ← 落ち着いた色
              }}
            >
              <span>{cat.category}</span>
              <span>{openCategory[i] ? "−" : "+"}</span>
            </div>

            {openCategory[i] && (
              <div>
                {cat.items.map((faq, j) => {
                  const key = `${i}-${j}`;
                  const isOpen = openItem[key];
                  return (
                    <div key={key} style={{ marginBottom: "1rem", border: "1px solid #444", borderRadius: "6px", overflow: "hidden" }}>
                      <div
                        onClick={() => toggleItem(key)}
                        style={{
                          cursor: "pointer",
                          backgroundColor: "#1a1a1a", // 質問背景（落ち着いたダークグレー）
                          padding: "0.8rem 1rem",
                          display: "flex",
                          justifyContent: "space-between",
                          alignItems: "center",
                          color: "#fff", // 質問文字は白
                        }}
                      >
                        <span style={{ fontWeight: "bold" }}>Q. {faq.q}</span>
                        <span>{isOpen ? "−" : "+"}</span>
                      </div>
                      <div
                        className={`faq-answer ${isOpen ? "open" : ""}`}
                        style={{
                          padding: isOpen ? "0.8rem 1rem" : "0 1rem",
                          backgroundColor: "#262626", // 答え背景は少し明るいグレー
                          color: "#ddd", // 答え文字は淡いグレー
                        }}
                      >
                        <p style={{ margin: 0, lineHeight: "1.6", whiteSpace: "pre-line" }}>
                        A. {faq.a}
                        </p>
                      </div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        ))}
      </div>
    </section>
  );
}
